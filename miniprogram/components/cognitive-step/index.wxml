<!--components/cognitive-step/index.wxml-->
<view class="cognitive-step-container">
  <!-- è¿›åº¦æ¡ -->
  <view class="progress-container">
    <view class="progress-label">å­¦ä¹ è¿›åº¦</view>
    <view class="progress-wrapper">
      <view class="progress-bar">
        <view class="progress-fill" style="width: {{currentProgress}}%">
        </view>
      </view>
      <view class="progress-text">{{currentProgress}}%</view>
    </view>
  </view>
  <!-- å­¦ä¹ å†…å®¹ -->
  <view
    wx:for="{{displayedItems}}"
    wx:key="{{index}}"
    class="content-item {{item.type}}-item {{index === displayedItems.length - 1 ? 'active' : 'completed'}}"
    data-step-index="{{item.stepIndex}}"
    data-sub-index="{{item.subIndex}}"
    bindtap="onItemClick">
    <view class="item-indicator">
      <view class="indicator-dot {{item.type === 'title' ? 'title-dot' : 'sub-dot'}}">
      </view>
      <view wx:if="{{index < displayedItems.length - 1}}" class="indicator-line">
      </view>
    </view>
    <view class="item-content">
      <view class="item-text {{item.type === 'title' ? 'title-text' : 'sub-text'}}">
        {{item.content}}
      </view>
      <!-- ç‚¹å‡»æç¤º -->
      <view wx:if="{{index === displayedItems.length - 1 && currentProgress < 100}}" class="click-hint">
        <text class="hint-text">ç‚¹å‡»ç»§ç»­</text>
        <view class="hint-arrow">â†’</view>
      </view>
    </view>
  </view>
</view>

<!-- å®Œæˆå¼¹çª— -->
<view wx:if="{{showCompletionModal}}" class="modal-overlay" bindtap="hideCompletionModal">
  <view class="modal-container" catchtap="preventClose">
    <view class="modal-content">
      <view class="modal-icon">ğŸ‰</view>
      <view class="modal-title">æ­å–œå®Œæˆï¼</view>
      <view class="modal-text">æ‚¨å·²å®Œæˆæ‰€æœ‰è®¤çŸ¥å­¦ä¹ å†…å®¹</view>
      <view class="modal-progress">
        <view class="modal-progress-text">å­¦ä¹ è¿›åº¦ï¼š{{currentProgress}}%</view>
        <view class="modal-progress-bar">
          <view class="modal-progress-fill" style="width: {{currentProgress}}%"></view>
        </view>
      </view>
      <view class="modal-buttons">
        <button class="modal-btn secondary" bindtap="hideCompletionModal">æŸ¥çœ‹å†…å®¹</button>
        <button class="modal-btn primary" bindtap="confirmCompletion">ç»§ç»­å­¦ä¹ </button>
      </view>
    </view>
  </view>
</view>