<!--pages/sleep-category/index.wxml-->
<view class="container">
  <!-- 头部信息 -->
  <view class="header" style="background-image: url('{{categoryInfo.coverImage}}');">
    <view class="header-overlay"></view>
    <view class="header-content">
      <text class="category-title">{{categoryInfo.title}}</text>
      <text class="category-desc">{{categoryInfo.description}}</text>
      <text class="track-count">{{audioList.length}} 首音频</text>
    </view>
  </view>

  <!-- 音频列表 -->
  <scroll-view scroll-y show-scrollbar="{{false}}" class="audio-list">
    <view 
      class="audio-item {{item.id === currentPlayingId ? 'playing' : ''}}" 
      wx:for="{{audioList}}" 
      wx:key="id"
      bindtap="playAudio"
      data-item="{{item}}"
    >
      <image class="cover-image" src="{{item.coverImgUrl}}" mode="aspectFill" />
      <view class="audio-info">
        <text class="audio-title">{{item.title}}</text>
        <text class="audio-artist">{{item.artist}}</text>
        <text class="audio-duration">{{item.duration}}</text>
      </view>
      <view class="audio-controls">
        <view class="favorite-btn" bindtap="toggleFavorite" data-id="{{item.id}}" catchtap>
          <image 
            class="icon" 
            src="{{item.isFavorite ? '/images/icons/heart-active.svg' : '/images/icons/heart.svg'}}"
          />
        </view>
        <view class="play-btn">
          <image 
            class="play-icon" 
            src="{{item.id === currentPlayingId && isPlaying ? '/images/icons/pause.svg' : '/images/icons/play.svg'}}"
          />
        </view>
      </view>
    </view>
  </scroll-view>

  <!-- 播放控制栏 -->
  <view class="player-bar" wx:if="{{currentAudio}}">
    <view class="player-info">
      <image class="player-cover" src="{{currentAudio.coverImgUrl}}" mode="aspectFill" />
      <view class="player-text">
        <text class="player-title">{{currentAudio.title}}</text>
        <text class="player-artist">{{currentAudio.artist}}</text>
      </view>
    </view>
    <view class="player-controls">
      <view class="control-btn" bindtap="togglePlay">
        <image 
          class="control-icon" 
          src="{{isPlaying ? '/images/icons/pause.svg' : '/images/icons/play.svg'}}"
        />
      </view>
    </view>
  </view>
</view>
